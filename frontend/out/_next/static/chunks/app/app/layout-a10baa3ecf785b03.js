(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{900:(e,s,t)=>{Promise.resolve().then(t.bind(t,2937))},2937:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eE});var a=t(5155),l=t(6046),n=t(6822),r=t(651),i=t(1093),c=t(1234),o=t(1183),d=t(2957),u=t(7778),m=t(7958),x=t(2115),h=t(814),p=t(1681),f=t(3572),g=t(1235),j=t(9393);let v=f.bL;f.l9;let N=f.ZL,y=x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(f.hJ,{className:(0,g.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l,ref:s})});y.displayName=f.hJ.displayName;let w=x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsxs)(N,{children:[(0,a.jsx)(y,{}),(0,a.jsx)(f.UC,{ref:s,className:(0,g.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l})]})});w.displayName=f.UC.displayName;let b=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};b.displayName="AlertDialogHeader";let k=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,g.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};k.displayName="AlertDialogFooter";let C=x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(f.hE,{ref:s,className:(0,g.cn)("text-lg font-semibold",t),...l})});C.displayName=f.hE.displayName;let A=x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(f.VY,{ref:s,className:(0,g.cn)("text-sm text-muted-foreground",t),...l})});A.displayName=f.VY.displayName;let _=x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(f.rc,{ref:s,className:(0,g.cn)((0,j.r)(),t),...l})});_.displayName=f.rc.displayName;let z=x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(f.ZD,{ref:s,className:(0,g.cn)((0,j.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...l})});z.displayName=f.ZD.displayName;var S=t(665),M=t(5325),R=t(7193),P=t(1703);let D=S.bL,O=S.l9;S.YJ,S.ZL,S.Pb,S.z6,x.forwardRef((e,s)=>{let{className:t,inset:l,children:n,...r}=e;return(0,a.jsxs)(S.ZP,{ref:s,className:(0,g.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l&&"pl-8",t),...r,children:[n,(0,a.jsx)(M.A,{className:"ml-auto"})]})}).displayName=S.ZP.displayName,x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.G5,{ref:s,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})}).displayName=S.G5.displayName;let T=x.forwardRef((e,s)=>{let{className:t,sideOffset:l=4,...n}=e;return(0,a.jsx)(S.ZL,{children:(0,a.jsx)(S.UC,{ref:s,sideOffset:l,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});T.displayName=S.UC.displayName;let E=x.forwardRef((e,s)=>{let{className:t,inset:l,...n}=e;return(0,a.jsx)(S.q7,{ref:s,className:(0,g.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",l&&"pl-8",t),...n})});E.displayName=S.q7.displayName,x.forwardRef((e,s)=>{let{className:t,children:l,checked:n,...r}=e;return(0,a.jsxs)(S.H_,{ref:s,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(S.VF,{children:(0,a.jsx)(R.A,{className:"h-4 w-4"})})}),l]})}).displayName=S.H_.displayName,x.forwardRef((e,s)=>{let{className:t,children:l,...n}=e;return(0,a.jsxs)(S.hN,{ref:s,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(S.VF,{children:(0,a.jsx)(P.A,{className:"h-2 w-2 fill-current"})})}),l]})}).displayName=S.hN.displayName,x.forwardRef((e,s)=>{let{className:t,inset:l,...n}=e;return(0,a.jsx)(S.JU,{ref:s,className:(0,g.cn)("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",t),...n})}).displayName=S.JU.displayName;let F=x.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.wv,{ref:s,className:(0,g.cn)("-mx-1 my-1 h-px bg-muted",t),...l})});F.displayName=S.wv.displayName;var L=t(8963),Y=t(9508);let q=(0,x.memo)(e=>{let{chat:s,isActive:t,onClick:l,onDelete:n,setOpenMobile:r}=e;return(0,a.jsxs)(L.FX,{children:[(0,a.jsx)(L.Uj,{asChild:!0,isActive:t,onClick:l,children:(0,a.jsx)("button",{children:s.title})}),(0,a.jsxs)(D,{modal:!0,children:[(0,a.jsx)(O,{asChild:!0,children:(0,a.jsxs)(L.e7,{className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground mr-0.5",showOnHover:!t,children:[(0,a.jsx)(p.jN,{}),(0,a.jsx)("span",{className:"sr-only",children:"More"})]})}),(0,a.jsx)(T,{side:"bottom",align:"end",children:(0,a.jsxs)(E,{className:"cursor-pointer text-destructive focus:bg-destructive/15 focus:text-destructive dark:text-red-500",onSelect:()=>n(s.uuid),children:[(0,a.jsx)(p.uc,{}),(0,a.jsx)("span",{children:"Delete"})]})})]})]})},(e,s)=>e.isActive===s.isActive);function $(){let{setOpenMobile:e}=(0,L.cL)(),s=(0,l.useRouter)(),{deleteChat:t,currentChatId:n,chats:r,isChatsLoading:i,tryToSetCurrentChat:c}=(0,Y.x)(),[p,f]=(0,x.useState)(null),[g,j]=(0,x.useState)(!1),N=async()=>{try{if(!p){h.oR.error("Failed to delete chat");return}j(!1),await t(p)}catch(e){h.oR.error("Failed to delete chat"),console.error("Error deleting chat:",e)}},y=t=>{c(t.uuid),e(!1),s.push("/app/chat")};if(i)return(0,a.jsxs)(L.Cn,{children:[(0,a.jsx)("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50",children:"Today"}),(0,a.jsx)(L.rQ,{children:(0,a.jsx)("div",{className:"flex flex-col",children:[44,32,28,64,52].map(e=>(0,a.jsx)("div",{className:"rounded-md h-8 flex gap-2 px-2 items-center",children:(0,a.jsx)("div",{className:"h-4 rounded-md flex-1 max-w-[--skeleton-width] bg-sidebar-accent-foreground/10",style:{"--skeleton-width":"".concat(e,"%")}})},e))})})]});if((null==r?void 0:r.length)===0)return(0,a.jsx)(L.Cn,{children:(0,a.jsx)(L.rQ,{children:(0,a.jsx)("div",{className:"px-2 text-zinc-500 w-full flex flex-row justify-center items-center text-sm gap-2",children:"Your conversations will appear here once you start chatting!"})})});let S=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=new Date,t=(0,o.k)(s,1),a=(0,d.a)(s,1);return Array.isArray(e)?[...e].sort((e,s)=>{let t=new Date(e.last_message_at);return new Date(s.last_message_at).getTime()-t.getTime()}).reduce((e,s)=>{let l=new Date(s.last_message_at);return(0,u.c)(l)?e.today.push(s):(0,m.P)(l)?e.yesterday.push(s):l>t?e.lastWeek.push(s):l>a?e.lastMonth.push(s):e.older.push(s),e},{today:[],yesterday:[],lastWeek:[],lastMonth:[],older:[]}):{today:[],yesterday:[],lastWeek:[],lastMonth:[],older:[]}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L.Cn,{children:(0,a.jsx)(L.rQ,{children:(0,a.jsx)(L.wZ,{children:r&&(()=>{let s=S(r);return(0,a.jsxs)(a.Fragment,{children:[s.today.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50",children:"Today"}),s.today.map(s=>(0,a.jsx)(q,{chat:s,isActive:s.uuid===n,onClick:()=>y(s),onDelete:e=>{f(e),j(!0)},setOpenMobile:e},s.uuid))]}),s.yesterday.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50 mt-6",children:"Yesterday"}),s.yesterday.map(s=>(0,a.jsx)(q,{chat:s,isActive:s.uuid===n,onClick:()=>y(s),onDelete:e=>{f(e),j(!0)},setOpenMobile:e},s.uuid))]}),s.lastWeek.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50 mt-6",children:"Last 7 days"}),s.lastWeek.map(s=>(0,a.jsx)(q,{chat:s,isActive:s.uuid===n,onClick:()=>y(s),onDelete:e=>{f(e),j(!0)},setOpenMobile:e},s.uuid))]}),s.lastMonth.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50 mt-6",children:"Last 30 days"}),s.lastMonth.map(s=>(0,a.jsx)(q,{chat:s,isActive:s.uuid===n,onClick:()=>y(s),onDelete:e=>{f(e),j(!0)},setOpenMobile:e},s.uuid))]}),s.older.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"px-2 py-1 text-xs text-sidebar-foreground/50 mt-6",children:"Older"}),s.older.map(s=>(0,a.jsx)(q,{chat:s,isActive:s.uuid===n,onClick:()=>y(s),onDelete:e=>{f(e),j(!0)},setOpenMobile:e},s.uuid))]})]})})()})})}),(0,a.jsx)(v,{open:g,onOpenChange:j,children:(0,a.jsxs)(w,{children:[(0,a.jsxs)(b,{children:[(0,a.jsx)(C,{children:"Are you absolutely sure?"}),(0,a.jsx)(A,{children:"This action cannot be undone."})]}),(0,a.jsxs)(k,{children:[(0,a.jsx)(z,{children:"Cancel"}),(0,a.jsx)(_,{onClick:N,children:"Continue"})]})]})})]})}var U=t(2472),Z=t(8482),J=t(6535),W=t(1354),V=t(7113),H=t(7908);function B(){let{theme:e,setTheme:s}=(0,V.D)(),{email:t,logout:l}=(0,H.A)();return(0,a.jsxs)(D,{children:[(0,a.jsx)(O,{asChild:!0,children:(0,a.jsxs)(j.$,{variant:"ghost",className:"w-full justify-start gap-2",children:[(0,a.jsx)(U.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"truncate",children:t})]})}),(0,a.jsxs)(T,{align:"end",children:[(0,a.jsx)(E,{onClick:()=>s("light"===e?"dark":"light"),children:"light"===e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z.A,{className:"h-4 w-4 mr-2"}),"Dark Mode"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"Light Mode"]})}),(0,a.jsx)(F,{}),(0,a.jsxs)(E,{onClick:l,children:[(0,a.jsx)(W.A,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})}var X=t(5565);function G(){return(0,a.jsx)("div",{className:"z-100 w-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"flex items-center justify-center py-2",children:(0,a.jsx)("a",{href:"https://www.idapt.ai/",className:"flex items-center justify-center font-nunito text-lg font-bold gap-2 ml-4",children:(0,a.jsx)(X.default,{className:"rounded-xl",src:"/images/idapt_logo.png",alt:"Idapt Logo",width:100,height:50,priority:!0})})})})}var I=t(1680),Q=t(5942),K=t(5524),ee=t(2783),es=t(3261),et=t(9471),ea=t(6838);let el=x.forwardRef((e,s)=>{let{className:t,value:l,...n}=e;return(0,a.jsx)(ea.bL,{ref:s,className:(0,g.cn)("relative h-2 w-full overflow-hidden rounded-full bg-gray-100",t),...n,children:(0,a.jsx)(ea.C1,{className:"h-full w-full flex-1 bg-blue-500 transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});el.displayName=ea.bL.displayName;var en=t(8694),er=t(652),ei=t(654);function ec(e){let{title:s,progress:t,total:l,completed:n,isMinimized:r,onMinimize:i,onClose:c,onCancel:o,children:d}=e;return(0,a.jsxs)("div",{className:"w-[19rem] bg-background border rounded-lg",children:[(0,a.jsxs)("div",{className:"p-3 border-b flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:s}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:i,children:r?(0,a.jsx)(en.A,{className:"h-4 w-4"}):(0,a.jsx)(er.A,{className:"h-4 w-4"})}),o&&(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:o,children:(0,a.jsx)(ei.A,{className:"h-4 w-4"})}),c&&(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:c,children:(0,a.jsx)(ei.A,{className:"h-4 w-4"})})]})]}),!r&&d,(l>0||t>0)&&(0,a.jsxs)("div",{className:"p-3 border-t bg-muted",children:[(0,a.jsx)("div",{className:"flex justify-between items-center text-xs text-muted-foreground mb-1",children:(0,a.jsxs)("span",{children:[t,"% (",n,"/",l,")"]})}),(0,a.jsx)(el,{value:t,className:"h-1"})]})]})}function eo(e){let{isDownloading:s,onClose:t}=e,{items:l}=(0,et.Y)(),[n,r]=(0,x.useState)(!1);return l.find(e=>"ollama"===e.type)?(0,a.jsx)(ec,{title:"Ollama status",progress:0,isMinimized:n,total:0,completed:0,onMinimize:()=>r(!n),onClose:t,children:(0,a.jsx)("div",{className:"px-3 py-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s?(0,a.jsx)(ee.A,{className:"h-3 w-3 animate-spin flex-shrink-0"}):(0,a.jsx)(es.A,{className:"h-3 w-3 flex-shrink-0"}),(0,a.jsxs)("span",{className:"text-xs",children:["At least one of your ollama servers is unreachable. ",(0,a.jsx)("br",{}),"Check if the ollama host url is correctly set up in the settings and datasources settings. ",(0,a.jsx)("br",{}),"Do not add trailing slashes to the url, use http if you did not set up https for your ollama server and use OLLAMA_HOST=0.0.0.0 if you want to access it from outside your local network. ",(0,a.jsx)("br",{}),'Check if when you access it in your browser, you see "Ollama is running". ',(0,a.jsx)("br",{}),"Any processing attempts done while you see this toast will be queued and processed once the provider is ready you trigger processing for a file."]})]})})}):null}var ed=t(1342),eu=t(689);function em(){let{items:e,removeItem:s,resetAll:t}=(0,et.Y)(),[l,n]=(0,x.useState)(!1),r=e.filter(e=>"upload"===e.type),i=r.filter(e=>"processing"===e.status||"pending"===e.status),c=r.filter(e=>"completed"===e.status);if((0,x.useEffect)(()=>{if(r.length>0&&0===i.length){let e=setTimeout(()=>{t()},1e3);return()=>clearTimeout(e)}},[r.length,i.length,t]),0===r.length)return null;let o=Math.round(r.reduce((e,s)=>e+s.progress,0)/r.length),d=r.length;return(0,a.jsx)(ec,{title:"File Uploads",progress:o,total:d,completed:c.length,isMinimized:l,onMinimize:()=>n(!l),children:(0,a.jsx)("div",{className:"max-h-[240px] overflow-y-auto",children:i.map(e=>(0,a.jsx)(ex,{item:e,onCancel:()=>s(e.id)},e.id))})})}function ex(e){let{item:s,onCancel:t}=e;return(0,a.jsxs)("div",{className:"px-3 py-2 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:["processing"===s.status&&(0,a.jsx)(ee.A,{className:"h-3 w-3 animate-spin flex-shrink-0"}),"completed"===s.status&&(0,a.jsx)(ed.A,{className:"h-3 w-3 text-green-500 flex-shrink-0"}),"error"===s.status&&(0,a.jsx)(I.A,{className:"h-3 w-3 text-red-500 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-xs truncate",children:s.name})]}),"processing"===s.status&&(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:t,children:(0,a.jsx)(eu.A,{className:"h-3 w-3"})})]}),"processing"===s.status&&(0,a.jsx)(el,{value:s.progress,className:"h-1 mt-1"})]})}function eh(){let{items:e,resetAll:s}=(0,et.Y)(),[t,l]=(0,x.useState)(!1),n=e.filter(e=>"deletion"===e.type),r=n.filter(e=>"processing"===e.status),i=n.filter(e=>"completed"===e.status);if((0,x.useEffect)(()=>{if(0===r.length&&i.length>0){let e=setTimeout(()=>{s()},1e3);return()=>clearTimeout(e)}},[r.length,i.length,s]),0===r.length&&0===i.length)return null;let c=r.length+i.length,o=Math.round(i.length/c*100);return(0,a.jsx)(ec,{title:"Deleting Items",progress:o,total:c,completed:i.length,isMinimized:t,onMinimize:()=>l(!t),children:(0,a.jsx)("div",{className:"max-h-[240px] overflow-y-auto",children:r.map(e=>(0,a.jsx)(ep,{item:e},e.id))})})}function ep(e){let{item:s}=e;return(0,a.jsx)("div",{className:"px-3 py-2 hover:bg-gray-50",children:(0,a.jsx)("div",{className:"flex justify-between items-center gap-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:["processing"===s.status&&(0,a.jsx)(ee.A,{className:"h-3 w-3 animate-spin flex-shrink-0"}),"completed"===s.status&&(0,a.jsx)(ed.A,{className:"h-3 w-3 text-green-500 flex-shrink-0"}),"error"===s.status&&(0,a.jsx)(I.A,{className:"h-3 w-3 text-red-500 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-xs truncate",children:s.name})]})})})}var ef=t(3244),eg=t(1333);let ej={initialDelay:1e3,maxDelay:3e4,maxAttempts:5};async function ev(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ej,t=0,a=s.initialDelay;for(;t<s.maxAttempts;)try{return await e()}catch(e){if(++t===s.maxAttempts)throw e;await new Promise(e=>setTimeout(e,a)),a=Math.min(2*a,s.maxDelay)}throw Error("Max attempts reached")}var eN=t(7925);let ey=(0,x.createContext)(null),ew="global-processing-status";function eb(e){let{children:s}=e,{status:t}=function(){let{backend:e}=(0,ef.T)(),{token:s}=(0,H.A)(),t=(0,eg.R)(),[a,l]=(0,x.useState)(null),n=(0,x.useRef)(null),r=(0,x.useRef)(null),i=(0,x.useRef)(!1),c=(0,x.useCallback)(async()=>{if(!e||!s||null===s)return;let a=(await (0,eN.kN)({client:t})).data;return l(null!=a?a:null),a},[e,t,s]),o=(0,x.useCallback)(async()=>{var t;if(e&&!i.current&&(null===(t=n.current)||void 0===t?void 0:t.readyState)!==WebSocket.OPEN)try{if(!s||null===s)throw Error("No token");i.current=!0,await ev(c);let t=e.replace(/^http/,"ws"),a=new WebSocket("".concat(t,"/api/processing/status/ws?token=").concat(s));n.current=a,a.onmessage=e=>{let s=JSON.parse(e.data);l(null!=s?s:null)},a.onclose=()=>{r.current=setTimeout(()=>{i.current=!1,o()},2e3)},a.onerror=()=>{a.close()}}catch(e){i.current=!1}},[e,s,c]);return(0,x.useEffect)(()=>(o(),()=>{i.current=!1,r.current&&clearTimeout(r.current),n.current&&n.current.close()}),[o]),{status:a}}(),{addItems:l,removeItem:n}=(0,et.Y)(),[r,i]=(0,x.useState)(!1),c=(0,x.useCallback)(()=>{var e,s;let a=((null==t?void 0:t.queued_count)||0)+((null==t?void 0:t.processing_count)||0),n=((null==t?void 0:null===(e=t.processing_items)||void 0===e?void 0:e.filter(e=>"completed"===e.status).length)||0)+((null==t?void 0:null===(s=t.queued_items)||void 0===s?void 0:s.filter(e=>"completed"===e.status).length)||0);l([{id:ew,name:"Processing Files",path:"",status:"processing",progress:a>0?Math.round(n/a*100):0,type:"processing",total:a,processed:n}]),i(!0)},[l,t]),o=(0,x.useCallback)(()=>{n(ew),i(!1)},[n]);return(0,a.jsx)(ey.Provider,{value:{status:t,showProcessingToast:c,hideProcessingToast:o,isToastVisible:r},children:s})}function ek(){let e=(0,x.useContext)(ey);if(!e)throw Error("useProcessingContext must be used within a ProcessingProvider");return e}function eC(e){var s;let{onClose:t}=e,{items:l,removeItem:n}=(0,et.Y)(),{status:r}=ek(),[i,c]=(0,x.useState)(!1);if(!l.find(e=>"processing"===e.type)||!r)return null;let o=r.queued_count+r.processing_count,d=(null===(s=r.processing_items)||void 0===s?void 0:s.filter(e=>"completed"===e.status).length)||0,u=o>0?Math.round(d/o*100):0,m=[...r.processing_items||[],...r.queued_items||[]],h=m.filter(e=>"processing"===e.status),p=m.filter(e=>"queued"===e.status),f=m.filter(e=>"completed"===e.status);return(0,a.jsx)(ec,{title:"Processing Files (".concat(d,"/").concat(o,")"),progress:u,total:o,completed:d,isMinimized:i,onMinimize:()=>c(!i),onClose:t,children:(0,a.jsxs)("div",{className:"max-h-[240px] overflow-y-auto space-y-2",children:[h.length>0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-xs font-medium text-gray-500 px-3",children:"Processing"}),h.map(e=>(0,a.jsx)(eA,{name:e.name,status:"processing",stacks:e.queued_stacks},e.original_path))]}),p.length>0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-xs font-medium text-gray-500 px-3",children:"Queued"}),p.map(e=>(0,a.jsx)(eA,{name:e.name,status:"queued",stacks:e.queued_stacks},e.original_path))]}),f.length>0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("div",{className:"text-xs font-medium text-gray-500 px-3",children:"Completed"}),f.map(e=>(0,a.jsx)(eA,{name:e.name,status:"completed",stacks:e.queued_stacks},e.original_path))]})]})})}function eA(e){let{name:s,status:t,stacks:l}=e;return(0,a.jsx)("div",{className:"px-3 py-2 hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:["processing"===t&&(0,a.jsx)(ee.A,{className:"h-3 w-3 animate-spin flex-shrink-0"}),"pending"===t&&(0,a.jsx)("div",{className:"h-3 w-3 bg-gray-200 rounded-full flex-shrink-0"}),"queued"===t&&(0,a.jsx)("div",{className:"h-3 w-3 bg-gray-200 rounded-full flex-shrink-0"}),"completed"===t&&(0,a.jsx)("div",{className:"h-3 w-3 bg-green-500 rounded-full flex-shrink-0"}),"error"===t&&(0,a.jsx)("div",{className:"h-3 w-3 bg-red-500 rounded-full flex-shrink-0"}),(0,a.jsx)("span",{className:"text-xs truncate",children:s})]}),l&&l.length>0&&(0,a.jsx)("div",{className:"flex gap-1 flex-wrap pl-5",children:l.map(e=>(0,a.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 bg-gray-100 rounded-full text-gray-600",children:e},e))})]})})}let e_=(0,x.createContext)(null),ez="ollama-status";function eS(e){let{children:s}=e,{isDownloading:t}=function(){let{backend:e}=(0,ef.T)(),{token:s}=(0,H.A)(),[t,a]=(0,x.useState)(!1),l=(0,eg.R)(),n=(0,x.useRef)(null),r=(0,x.useRef)(null),i=(0,x.useRef)(!1),c=(0,x.useCallback)(async()=>{if(!e||!s||null===s)return;let t=(await (0,eN.U5)({client:l})).data;return a(t.is_downloading),t},[e,l,s]),o=(0,x.useCallback)(async()=>{var t;if(e&&!i.current&&(null===(t=n.current)||void 0===t?void 0:t.readyState)!==WebSocket.OPEN)try{if(!s||null===s)throw Error("No token");i.current=!0,await ev(c);let t=e.replace(/^http/,"ws"),l=new WebSocket("".concat(t,"/api/ollama-status/ws?token=").concat(s));n.current=l,l.onmessage=e=>{let s=JSON.parse(e.data);a(s.is_downloading)},l.onclose=()=>{r.current=setTimeout(()=>{i.current=!1,o()},2e3)},l.onerror=()=>{l.close()}}catch(e){i.current=!1}},[e,c,s]);return(0,x.useEffect)(()=>(o(),()=>{i.current=!1,r.current&&clearTimeout(r.current),n.current&&n.current.close()}),[o]),{isDownloading:t}}(),{addItems:l,removeItem:n}=(0,et.Y)(),[r,i]=(0,x.useState)(!1),c=(0,x.useCallback)(()=>{l([{id:ez,name:"Ollama Status",path:"",status:"pending",progress:0,type:"ollama"}]),i(!0)},[l]),o=(0,x.useCallback)(()=>{n(ez),i(!1)},[n]);return(0,a.jsx)(e_.Provider,{value:{isDownloading:t,showOllamaToast:c,hideOllamaToast:o,isToastVisible:r},children:s})}function eM(){var e;let{items:s}=(0,et.Y)(),[t,l]=(0,x.useState)(null),{isDownloading:n,showOllamaToast:r,hideOllamaToast:i,isToastVisible:c}=function(){let e=(0,x.useContext)(e_);if(!e)throw Error("useOllamaContext must be used within an OllamaProvider");return e}(),{status:o,showProcessingToast:d,hideProcessingToast:u}=ek(),m=s.find(e=>"ollama"===e.type),h=s.filter(e=>"upload"===e.type),p=s.filter(e=>"deletion"===e.type),f=s.filter(e=>"processing"===e.type),g=()=>{var e,s;return(null==o?void 0:null===(e=o.processing_items)||void 0===e?void 0:e.some(e=>"error"===e.status))?"text-red-500":(null==o?void 0:null===(s=o.processing_items)||void 0===s?void 0:s.every(e=>"completed"===e.status))?"text-green-500":"text-foreground"};return m||h.length||p.length||f.length||n||(null==o?void 0:o.queued_count)!==0||(null==o?void 0:o.processing_count)!==0?(0,a.jsxs)("div",{children:["ollama"===t&&(0,a.jsx)(eo,{isDownloading:n,onClose:()=>{i(),l(null)}}),"upload"===t&&(0,a.jsx)(em,{}),"deletion"===t&&(0,a.jsx)(eh,{}),"processing"===t&&(0,a.jsx)(eC,{onClose:()=>{u(),l(null)}}),(0,a.jsxs)("div",{className:"flex gap-2 p-2",children:[(c||n)&&(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8 ".concat("ollama"===t?"bg-accent":""),onClick:()=>{"ollama"===t?(i(),l(null)):(r(),l("ollama"))},children:(0,a.jsx)(I.A,{className:"h-4 w-4 text-yellow-500"})}),h.length>0&&(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8 ".concat("upload"===t?"bg-accent":""),onClick:()=>l("upload"===t?null:"upload"),children:(0,a.jsx)(Q.A,{className:"h-4 w-4 ".concat(h.some(e=>"error"===e.status)?"text-red-500":h.every(e=>"completed"===e.status)?"text-green-500":"text-foreground")})}),p.length>0&&(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8 ".concat("deletion"===t?"bg-accent":""),onClick:()=>l("deletion"===t?null:"deletion"),children:(0,a.jsx)(K.A,{className:"h-4 w-4 ".concat(p.some(e=>"error"===e.status)?"text-red-500":p.every(e=>"completed"===e.status)?"text-green-500":"text-foreground")})}),(((null==o?void 0:o.queued_count)||0)>0||((null==o?void 0:o.processing_count)||0)>0)&&(0,a.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8 ".concat("processing"===t?"bg-accent":""),onClick:()=>{"processing"===t?(u(),l(null)):(d(),l("processing"))},children:(null==o?void 0:null===(e=o.processing_items)||void 0===e?void 0:e.some(e=>"processing"===e.status))?(0,a.jsx)(ee.A,{className:"h-4 w-4 animate-spin ".concat(g())}):(0,a.jsx)(es.A,{className:"h-4 w-4 ".concat(g())})})]})]}):null}function eR(){let{setOpenMobile:e}=(0,L.cL)(),s=(0,l.useRouter)(),t=(0,l.usePathname)().split("/")[2];return(0,a.jsxs)(L.Bx,{className:"group-data-[side=left]:border-r-0",children:[(0,a.jsxs)(L.Gh,{children:[(0,a.jsx)(G,{}),(0,a.jsx)(L.wZ,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-2 px-2",children:[(0,a.jsxs)(j.$,{variant:"ghost",className:"justify-start gap-2 w-full ".concat("chat"===t?"bg-accent":""),onClick:()=>{e(!1),s.push("/app/chat")},children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),"Chat"]}),(0,a.jsxs)(j.$,{variant:"ghost",className:"justify-start gap-2 w-full ".concat("files"===t?"bg-accent":""),onClick:()=>{e(!1),s.push("/app/files")},children:[(0,a.jsx)(r.A,{className:"h-4 w-4"}),"Files"]}),(0,a.jsxs)(j.$,{variant:"ghost",className:"justify-start gap-2 w-full ".concat("settings"===t?"bg-accent":""),onClick:()=>{e(!1),s.push("/app/settings")},children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),"Settings"]}),(0,a.jsxs)(j.$,{variant:"ghost",className:"justify-start gap-2 w-full ".concat("processing"===t?"bg-accent":""),onClick:()=>{e(!1),s.push("/app/processing")},children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),"Processing Stacks"]})]})})]}),(0,a.jsx)("div",{className:"h-[1px] bg-border my-2 mx-2"}),(0,a.jsx)(L.Yv,{children:(0,a.jsx)($,{})}),(0,a.jsxs)(L.CG,{children:[(0,a.jsx)(eM,{}),(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)(B,{})})]})]})}var eP=t(2354);function eD(e){let{className:s}=e,{toggleSidebar:t}=(0,L.cL)();return(0,a.jsxs)(eP.m_,{children:[(0,a.jsx)(eP.k$,{asChild:!0,children:(0,a.jsx)(j.$,{onClick:t,variant:"outline",className:"md:px-2 md:h-fit",children:(0,a.jsx)(p.j0,{size:16})})}),(0,a.jsx)(eP.ZI,{align:"start",children:"Toggle Sidebar"})]})}let eO=(0,x.createContext)(void 0);function eT(e){let{children:s}=e,[t,l]=(0,x.useState)(!1);return(0,a.jsx)(eO.Provider,{value:{isOpen:t,openProcessingStacks:()=>l(!0),closeProcessingStacks:()=>l(!1)},children:s})}function eE(e){let{children:s}=e,{isAuthenticated:t}=(0,H.A)(),n=(0,l.useRouter)();return(0,x.useEffect)(()=>{t||n.push("/auth/login")},[t,n]),(0,a.jsx)(et.k,{children:(0,a.jsx)(eS,{children:(0,a.jsx)(eb,{children:(0,a.jsx)(Y.k,{children:(0,a.jsx)(L.GB,{children:(0,a.jsx)(eT,{children:(0,a.jsxs)("div",{className:"flex h-screen w-screen overflow-hidden",children:[(0,a.jsx)(eR,{}),(0,a.jsx)("div",{className:"flex justify-between pt-1.5 pl-1.5",children:(0,a.jsx)(eD,{})}),(0,a.jsx)("main",{className:"flex-1 relative overflow-hidden",children:s})]})})})})})})})}},7925:(e,s,t)=>{"use strict";t.d(s,{Bo:()=>a.Bo,Dz:()=>a.Dz,HT:()=>a.HT,IV:()=>a.IV,Lz:()=>a.Lz,Sc:()=>a.Sc,U5:()=>a.U5,XU:()=>a.XU,YP:()=>a.YP,bJ:()=>a.bJ,cX:()=>a.cX,cn:()=>a.cn,eE:()=>a.eE,fw:()=>a.fw,go:()=>a.go,hV:()=>a.hV,kC:()=>a.kC,kN:()=>a.kN,mc:()=>a.mc,tF:()=>a.tF,v9:()=>a.v9,vB:()=>a.vB,xA:()=>a.xA,xz:()=>a.xz});var a=t(1601)},9471:(e,s,t)=>{"use strict";t.d(s,{Y:()=>i,k:()=>r});var a=t(5155),l=t(2115);let n=(0,l.createContext)(null);function r(e){let{children:s}=e,[t,r]=(0,l.useState)([]),i=(0,l.useCallback)(e=>{r(s=>[...s,...e])},[]),c=(0,l.useCallback)((e,s)=>{r(t=>t.map(t=>t.id===e?{...t,...s}:t))},[]),o=(0,l.useCallback)(e=>{r(s=>s.filter(s=>s.id!==e))},[]),d=(0,l.useCallback)(()=>{r([])},[]);return(0,a.jsx)(n.Provider,{value:{items:t,addItems:i,updateItem:c,removeItem:o,resetAll:d},children:s})}function i(){let e=(0,l.useContext)(n);if(!e)throw Error("useToastContext must be used within a ToastContextProvider");return e}}},e=>{var s=s=>e(e.s=s);e.O(0,[738,906,119,895,641,565,814,153,355,474,908,886,441,517,358],()=>s(900)),_N_E=e.O()}]);