(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[402],{6443:(e,t,a)=>{Promise.resolve().then(a.bind(a,2646))},2646:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ee});var s=a(5155),r=a(4683),l=a(5942),n=a(4057);let i=(0,n.A)("FolderUp",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]]),o=(0,n.A)("Grid2x2",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 12h18",key:"1i2n21"}],["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}]]),c=(0,n.A)("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);var d=a(2783),u=a(2115),h=a(9393),p=a(651);let m=(0,n.A)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),x=(0,n.A)("CircleDashed",[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]]),f=(0,n.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var g=a(1342);let v=(0,n.A)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);var y=a(1680);let j=(0,n.A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),b=(0,n.A)("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),w=(0,n.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),N=(0,n.A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var k=a(689),_=a(5524),C=a(665),S=a(705),A=a(5714);function E(e){return e?A.Buffer.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_"):""}var M=a(9471),z=a(1333),D=a(2971),F=a(7925);function R(){let e=(0,z.R)();return{processWithStack:async(t,a)=>{try{let l=[],n=[];for(let e of t){let t=e.split("/")[0];n.includes(t)||(n.push(t),l.push([])),l[n.indexOf(t)].push({original_path:e,stacks_identifiers_to_queue:[a]})}for(let t in l){let a=await (0,F.mc)({client:e,body:{items:l[t]}});if(a.error){var s,r;throw Error((null===(r=a.error.detail)||void 0===r?void 0:null===(s=r[0])||void 0===s?void 0:s.msg)||"Unknown error")}}}catch(e){throw console.error("Processing error:",e),e}}}}function U(e){let{id:t,name:a,type:r,size:l,modified:n,accessed:i,path:o,mimeType:c,stacks_to_process:d,processed_stacks:A,error_message:U,status:P,onClick:L,onRefresh:I,viewMode:T="list"}=e,{stacks:O}=(0,D.s)(),{processWithStack:$}=R(),[q,H]=(0,u.useState)(!1),[V,B]=(0,u.useState)(a),[Y,J]=(0,u.useState)(!1),{startDeletion:G,completeDeletion:X,failDeletion:Z}=function(){let{addItems:e,updateItem:t,removeItem:a}=(0,M.Y)();return{startDeletion:(t,a)=>{let s=crypto.randomUUID();return e([{id:s,name:t,path:a,status:"processing",progress:0,type:"deletion"}]),s},completeDeletion:e=>{t(e,{status:"completed",progress:100})},failDeletion:e=>{t(e,{status:"error",progress:0})}}}(),Q=(0,z.R)(),W=async()=>{try{let e;let t=E(o),s=o.split("/")[0];if(!(e="folder"===r?await (0,F.bJ)({client:Q,path:{encoded_original_path:t,datasource_name:s}}):await (0,F.v9)({client:Q,path:{encoded_original_path:t,datasource_name:s}})).response.ok)throw Error("Download failed");let l=await e.response.blob(),n=window.URL.createObjectURL(l),i=document.createElement("a");i.href=n,i.download="folder"===r?a+".zip":a;try{document.body.appendChild(i),i.click()}finally{window.URL.revokeObjectURL(n),document.body.removeChild(i)}}catch(e){console.error("Download failed:",e),alert("Failed to download item")}},K=async()=>{if(o&&confirm("Are you sure you want to delete ".concat(a,"?")))try{let e=G(a,o),t=o.split("/")[0];if(!t)throw Error("Failed to get datasource name");let s=E(o),r=await (0,F.Dz)({client:Q,path:{encoded_original_path:s,datasource_name:t}});if(!r.response.ok){let t=await r.response.json();if(409===r.response.status){alert("This item is currently being processed and cannot be deleted. Please try again once processing is complete."),Z(e);return}throw Error(t.detail||"Delete failed")}X(e),null==I||I()}catch(e){console.error("Delete failed:",e),alert(e instanceof Error?e.message:"Failed to delete item")}},ee=async()=>{if(o&&confirm("Are you sure you want to delete all processed data for ".concat(a,"?")))try{let e=o.split("/")[0];if(!e)throw Error("Failed to get datasource name");let t=E(o);if(!(await (0,F.Lz)({client:Q,path:{encoded_original_path:t,datasource_name:e}})).response.ok)throw Error("Failed to delete processed data");null==I||I()}catch(e){console.error("Delete processed data failed:",e),alert(e instanceof Error?e.message:"Failed to delete processed data")}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"group relative flex flex-col items-center w-full h-full hover:bg-gray-50 rounded-lg cursor-pointer",onClick:e=>{if(e.target instanceof Element&&(e.target.closest('[role="menu"]')||e.target.closest('button[role="trigger"]'))){e.stopPropagation();return}null==L||L()},children:[(0,s.jsxs)("div",{className:"flex-1 flex items-center justify-center relative",children:["folder"===r?(0,s.jsx)(p.A,{className:"h-12 w-12 text-blue-500"}):(0,s.jsx)(m,{className:"h-12 w-12 text-gray-500"}),P&&(0,s.jsxs)("div",{className:"absolute bottom-2 -right-1 bg-white rounded-full",children:["pending"===P&&(0,s.jsx)(x,{className:"h-5 w-5 text-red-500"}),"queued"===P&&(0,s.jsx)(f,{className:"h-5 w-5 text-yellow-500"}),"completed"===P&&(0,s.jsx)(g.A,{className:"h-5 w-5 text-green-500"}),"processing"===P&&(0,s.jsx)(v,{className:"h-5 w-5 text-blue-500"}),"error"===P&&(0,s.jsx)(y.A,{className:"h-5 w-5 text-red-500"})]})]}),(0,s.jsxs)("div",{className:"w-full px-1 mt-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 text-center truncate",children:a}),l&&(0,s.jsx)("p",{className:"text-xs text-gray-500 text-center truncate",children:l})]}),(0,s.jsxs)(C.rI,{children:[(0,s.jsx)(C.ty,{asChild:!0,children:(0,s.jsx)(h.$,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100",children:(0,s.jsx)(j,{className:"h-4 w-4"})})}),(0,s.jsxs)(C.SQ,{align:"end",className:"w-[200px] p-0.5 bg-white rounded-md shadow-md z-50",children:[O.map(e=>(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md flex items-center",onSelect:()=>{$([o],e.identifier)},children:[(0,s.jsx)(b,{className:"h-4 w-4 mr-2"}),(0,s.jsxs)("span",{children:["Process with ",e.display_name]})]},e.identifier)),(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md flex items-center",onSelect:W,children:[(0,s.jsx)(w,{className:"h-4 w-4 mr-2"}),(0,s.jsx)("span",{children:"Download"})]}),(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md flex items-center",onSelect:()=>J(!0),children:[(0,s.jsx)(N,{className:"h-4 w-4 mr-2"}),(0,s.jsx)("span",{children:"Details"})]}),(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md text-red-600 flex items-center",onSelect:ee,children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"}),(0,s.jsx)("span",{children:"Delete Processed Data"})]}),(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md text-red-600 flex items-center",onSelect:K,children:[(0,s.jsx)(_.A,{className:"h-4 w-4 mr-2"}),(0,s.jsx)("span",{children:"Delete"})]})]})]})]}),(0,s.jsx)(S.lG,{open:Y,onOpenChange:J,children:(0,s.jsxs)(S.Cf,{children:[(0,s.jsx)(S.c7,{children:(0,s.jsxs)(S.L3,{children:[a," Details"]})}),(0,s.jsxs)("div",{className:"space-y-2 p-4",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Type:"})," ",r]}),l&&(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Size:"})," ",l]}),n&&(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Modified:"})," ",n]}),i&&(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Last Accessed:"})," ",i]}),o&&(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Path:"})," ",o]}),A&&(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Processed with stacks:"}),(0,s.jsx)("div",{className:"mt-1",children:JSON.parse(A).map(e=>(0,s.jsx)("span",{className:"inline-block bg-green-100 text-green-800 px-2 py-1 rounded mr-2 mb-2 text-sm",children:e},e))})]}),d&&(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Pending processing with stacks:"}),(0,s.jsx)("div",{className:"mt-1",children:JSON.parse(d).map(e=>(0,s.jsx)("span",{className:"inline-block bg-yellow-100 text-yellow-800 px-2 py-1 rounded mr-2 mb-2 text-sm",children:e},e))})]}),U&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("strong",{className:"text-red-600",children:"Processing Error:"}),(0,s.jsx)("div",{className:"mt-1 p-2 bg-red-50 text-red-700 rounded border border-red-200",children:U})]})]})]})})]})}var P=a(1093),L=a(6631),I=a(9367);let T=()=>{let e=(0,z.R)();return{getAllDatasources:async()=>await (0,F.xA)({client:e}),getDatasource:async t=>await (0,F.Bo)({client:e,path:{datasource_name:t}}),deleteDatasource:async t=>{try{await (0,F.fw)({client:e,path:{datasource_name:t}})}catch(e){throw console.error("Delete failed:",e),e}},createDatasource:async(t,a)=>{await (0,F.tF)({client:e,path:{datasource_name:t},body:a})},updateDatasource:async(t,a)=>{await (0,F.IV)({client:e,path:{datasource_name:t},body:a})}}},O=(0,n.A)("MessagesSquare",[["path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2z",key:"p1xzt8"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1",key:"1cx29u"}]]),$=(0,n.A)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),q=(0,n.A)("FolderSync",[["path",{d:"M9 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v.5",key:"1dkoa9"}],["path",{d:"M12 10v4h4",key:"1czhmt"}],["path",{d:"m12 14 1.535-1.605a5 5 0 0 1 8 1.5",key:"lvuxfi"}],["path",{d:"M22 22v-4h-4",key:"1ewp4q"}],["path",{d:"m22 18-1.535 1.605a5 5 0 0 1-8-1.5",key:"14ync0"}]]);var H=a(1234);function V(e){let{type:t,className:a="h-12 w-12"}=e;return(0,s.jsxs)("div",{className:"relative",children:["CHATS"===t?(0,s.jsx)(O,{className:"".concat(a," text-gray-500")}):"FILES"===t?(0,s.jsx)($,{className:"".concat(a," text-gray-500")}):"WINDOWS_SYNC"===t?(0,s.jsx)(q,{className:"".concat(a," text-gray-500")}):(0,s.jsx)(H.A,{className:"".concat(a," text-gray-500")}),(0,s.jsx)(H.A,{className:"h-5 w-5 text-gray-500 absolute -bottom-1 -right-1 bg-white rounded-full"})]})}function B(e){let{datasource:t,onClick:a,onRefresh:r}=e,[l,n]=(0,u.useState)(!1),[i,o]=(0,u.useState)(t.description||""),[c,d]=(0,u.useState)(t.embedding_setting_identifier||""),[p,m]=(0,u.useState)(!1),[x,f]=(0,u.useState)(null),{deleteDatasource:g,updateDatasource:v}=T(),{stacks:y}=(0,D.s)(),{processWithStack:w}=R();(0,u.useEffect)(()=>{o(t.description||"")},[t.description]);let N=async()=>{try{f(null),m(!0),await v(t.name,{description:i,embedding_setting_identifier:c}),null==r||r(),n(!1)}catch(e){console.error("Save failed:",e),f("Failed to save settings")}finally{m(!1)}},k=async()=>{confirm('Are you sure you want to delete datasource "'.concat(t.name,'"?'))&&(await g(t.name),null==r||r())};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"group relative flex flex-col items-center w-full h-full p-2 hover:bg-gray-100 rounded-lg ".concat("FILES"===t.type?"cursor-pointer":"cursor-default"),onClick:e=>{if(e.target instanceof Element&&(e.target.closest('[role="menu"]')||e.target.closest('button[role="trigger"]'))){e.stopPropagation();return}null==a||a()},children:[(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,s.jsx)(V,{type:t.type})}),(0,s.jsxs)("div",{className:"w-full px-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 text-center truncate",children:t.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500 text-center truncate",children:"Datasource"})]}),(0,s.jsxs)(C.rI,{children:[(0,s.jsx)(C.ty,{asChild:!0,children:(0,s.jsx)(h.$,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100",children:(0,s.jsx)(j,{className:"h-4 w-4"})})}),(0,s.jsxs)(C.SQ,{align:"end",className:"w-[200px] p-0.5 bg-white rounded-md shadow-md z-50",children:["FILES"===t.type&&y.map(e=>(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md flex items-center",onSelect:()=>{w([t.name],e.identifier)},children:[(0,s.jsx)(b,{className:"h-4 w-4 mr-2"}),(0,s.jsxs)("span",{children:["Process with ",e.display_name]})]},e.identifier)),(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md flex items-center",onSelect:()=>n(!0),children:[(0,s.jsx)(P.A,{className:"h-4 w-4 mr-2"}),(0,s.jsx)("span",{children:"Settings"})]}),(0,s.jsxs)(C._2,{className:"cursor-pointer p-2 hover:bg-gray-100 rounded-md text-red-600 flex items-center",onSelect:k,children:[(0,s.jsx)(_.A,{className:"h-4 w-4 mr-2"}),(0,s.jsx)("span",{children:"Delete"})]})]})]})]}),(0,s.jsx)(S.lG,{open:l,onOpenChange:n,children:(0,s.jsxs)(S.Cf,{children:[(0,s.jsx)(S.c7,{children:(0,s.jsx)(S.L3,{children:"Datasource Settings"})}),(0,s.jsxs)("div",{className:"space-y-4 p-4",children:[x&&(0,s.jsx)("div",{className:"text-red-500 text-sm mb-2",children:x}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Name"}),(0,s.jsx)("p",{className:"mt-1",children:t.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Type"}),(0,s.jsx)("p",{className:"mt-1",children:t.type})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Description"}),(0,s.jsx)(L.T,{className:"mt-1",value:i,onChange:e=>o(e.target.value),placeholder:"Enter datasource description...",autoFocus:!1})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Embedding Setting Identifier"}),(0,s.jsx)(I.p,{className:"mt-1",value:c,onChange:e=>d(e.target.value),placeholder:"Enter embedding setting identifier...",autoFocus:!1})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(h.$,{variant:"outline",onClick:()=>{o(t.description||""),n(!1)},children:"Cancel"}),(0,s.jsx)(h.$,{onClick:N,disabled:p,children:p?"Saving...":"Save Changes"})]})]})]})})]})}function Y(e){let{files:t,folders:a,datasources:r,viewMode:l,onFolderClick:n,onDatasourceClick:i,onUploadComplete:o}=e;return(0,s.jsxs)("div",{className:"grid"===l?"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-2 p-4":"space-y-1 p-4",children:[null==r?void 0:r.map(e=>(0,s.jsx)("div",{className:"w-[120px] h-[120px]",children:(0,s.jsx)(B,{datasource:e,onClick:()=>null==i?void 0:i(e),onRefresh:o})},"datasource-".concat(e.identifier))),a.map(e=>(0,s.jsx)("div",{className:"w-[120px] h-[120px]",children:(0,s.jsx)(U,{id:e.id,name:e.name,type:"folder",path:e.original_path,modified:e.uploaded_at.toString(),accessed:e.uploaded_at.toString(),onClick:()=>n(e.original_path),onRefresh:o,viewMode:l})},"folder-".concat(e.id))),t.map(e=>{var t,a,r,n,i;return(0,s.jsx)("div",{className:"h-[120px] w-[120px]",children:(0,s.jsx)(U,{id:e.id,name:e.name,type:"file",size:null===(t=e.size)||void 0===t?void 0:t.toString(),modified:e.uploaded_at.toString(),accessed:e.uploaded_at.toString(),path:e.original_path,mimeType:null!==(a=e.mime_type)&&void 0!==a?a:void 0,stacks_to_process:null!==(r=e.stacks_to_process)&&void 0!==r?r:void 0,processed_stacks:null!==(n=e.processed_stacks)&&void 0!==n?n:void 0,status:e.status,error_message:null!==(i=e.error_message)&&void 0!==i?i:void 0,onRefresh:o,viewMode:l})},"file-".concat(e.id))})]})}let J=(0,n.A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var G=a(5325);function X(e){let{currentPath:t,currentDatasource:a,onNavigate:r}=e,l=t?t.split("/").filter(Boolean):[];return(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)(h.$,{variant:"ghost",size:"sm",className:"flex items-center gap-1",onClick:()=>r(""),children:[(0,s.jsx)(J,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Datasources"})]}),l.length>0&&l.map((e,t)=>{let n=l.slice(0,t+1).join("/");return 0===t&&e==(null==a?void 0:a.identifier)?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(G.A,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsxs)(h.$,{variant:"ghost",size:"sm",className:"flex items-center gap-1",onClick:()=>r(n),children:[(0,s.jsx)(H.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:a.name})]})]},n):(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(G.A,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)(h.$,{variant:"ghost",size:"sm",className:"flex items-center gap-1",onClick:()=>r(n),children:e})]},n)})]})}function Z(){let e=(0,z.R)(),[t,a]=(0,u.useState)(!1);return{uploadFileApi:async t=>{try{a(!0);let s=t.original_path.split("/")[0];await (0,F.vB)({client:e,path:{datasource_name:s},body:t})}catch(e){throw console.error("Upload error:",e),e}finally{a(!1)}},isUploading:t}}function Q(){let{addItems:e,updateItem:t,removeItem:a}=(0,M.Y)();return{startUpload:(t,a)=>{let s=crypto.randomUUID();return e([{id:s,name:t,path:a,status:"pending",progress:0,type:"upload"}]),s},updateUpload:(e,a)=>{t(e,{status:"processing",progress:a})},completeUpload:e=>{t(e,{status:"completed",progress:100})},failUpload:e=>{t(e,{status:"error",progress:0})}}}function W(e){let{open:t,onClose:a,onCreated:r}=e,{createDatasource:l}=T(),[n,i]=(0,u.useState)(""),[o,c]=(0,u.useState)(""),[d,p]=(0,u.useState)(""),[m,x]=(0,u.useState)(!1),[f,g]=(0,u.useState)(null),v=async()=>{if(n.trim())try{x(!0),g(null),await l(n.trim(),{type:"FILES",description:o,settings_json:"{}",embedding_setting_identifier:d}),r(),a()}catch(e){g(e instanceof Error?e.message:"Failed to create datasource")}finally{x(!1)}};return(0,s.jsx)(S.lG,{open:t,onOpenChange:a,children:(0,s.jsxs)(S.Cf,{children:[(0,s.jsx)(S.c7,{children:(0,s.jsx)(S.L3,{children:"Create New Datasource"})}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Name"}),(0,s.jsx)(I.p,{value:n,onChange:e=>i(e.target.value),placeholder:"Enter datasource name"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Description"}),(0,s.jsx)(L.T,{value:o,onChange:e=>c(e.target.value),placeholder:"Enter datasource description",rows:3})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Embedding Setting Identifier"}),(0,s.jsx)(I.p,{value:d,onChange:e=>p(e.target.value),placeholder:"Enter embedding setting identifier"})]}),f&&(0,s.jsx)("p",{className:"text-sm text-red-500 mt-1",children:f}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,s.jsx)(h.$,{variant:"outline",onClick:a,children:"Cancel"}),(0,s.jsx)(h.$,{onClick:v,disabled:m,children:m?"Creating...":"Create"})]})]})]})})}function K(){let{currentPath:e,currentDatasource:t,files:a,folders:n,datasources:p,error:m,loading:x,navigateToFolder:f,refreshContents:g}=function(){let e=(0,z.R)(),[t,a]=(0,u.useState)(""),[s,r]=(0,u.useState)([]),[l,n]=(0,u.useState)([]),[i,o]=(0,u.useState)([]),[c,d]=(0,u.useState)(),[h,p]=(0,u.useState)(!1),[m,x]=(0,u.useState)(null),f=(0,u.useCallback)(async t=>{try{p(!0);let l=null==t?void 0:t.split("/").filter(Boolean);if(t&&l&&0!==l.length){var a,s;let i=l[0],o=await (0,F.Bo)({client:e,path:{datasource_name:i}});d(o.data);let c=E(t),u=await (0,F.xz)({client:e,path:{encoded_original_path:c,datasource_name:i},query:{include_child_folders_files_recursively:!1}});r((null===(a=u.data)||void 0===a?void 0:a.child_files)||[]),n((null===(s=u.data)||void 0===s?void 0:s.child_folders)||[])}else{let t=await (0,F.xA)({client:e});r([]),n([]),o(t.data||[]),d(void 0)}}catch(e){x(e instanceof Error?e.message:"Failed to fetch contents")}finally{p(!1)}},[e]),g=(0,u.useCallback)(e=>{a(e),f(e)},[f]);return(0,u.useEffect)(()=>{f()},[f]),{files:s,folders:l,datasources:i,currentPath:t,currentDatasource:c,loading:h,error:m,navigateToFolder:g,refreshContents:()=>f(t)}}(),[v,y]=(0,u.useState)("grid"),[j,b]=(0,u.useState)(!1),w=(0,u.useRef)(null),N=(0,u.useRef)(null),{uploadFile:k}=function(){let{uploadFileApi:e,isUploading:t}=Z(),{startUpload:a,updateUpload:s,completeUpload:r,failUpload:l}=Q();return{uploadFile:async function(t){var s,n;let i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=arguments.length>2?arguments[2]:void 0;try{i=a(t.name,o?"".concat(o,"/").concat(t.name):t.name);let l=await new Promise(e=>{let a=new FileReader;a.onload=()=>{let s=a.result,r=t.type||"application/octet-stream";e("data:".concat(r,";base64,").concat(s.split(",")[1]))},a.readAsDataURL(t)});await e({original_path:o?"".concat(o,"/").concat(t.name):t.name,base64_content:l,name:t.name,file_created_at:t.lastModified/1e3,file_modified_at:t.lastModified/1e3}),r(i),null==c||null===(s=c.onComplete)||void 0===s||s.call(c)}catch(e){i&&l(i),null==c||null===(n=c.onError)||void 0===n||n.call(c,e instanceof Error?e.message:"Upload failed")}},isUploading:t}}(),{uploadFolder:_}=function(){let{uploadFileApi:e,isUploading:t}=Z(),{startUpload:a,updateUpload:s,completeUpload:r,failUpload:l}=Q(),n=async(t,a,s)=>{try{let l=await new Promise((e,a)=>{let s=new FileReader;s.onload=()=>{let r=s.result,l=t.type||"application/octet-stream";e("data:".concat(l,";base64,").concat(r.split(",")[1])),s.onerror=()=>a(s.error)},s.readAsDataURL(t)});await e({original_path:a?"".concat(a,"/").concat(t.webkitRelativePath):t.webkitRelativePath,base64_content:l,name:t.name,file_created_at:t.lastModified/1e3,file_modified_at:t.lastModified/1e3}),r(s)}catch(e){throw l(s),e}};return{uploadFolder:async function(e){var t,s,r,i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=arguments.length>2?arguments[2]:void 0;if(!(null===(t=e.files)||void 0===t?void 0:t.length))return;let d=Array.from(e.files),u=(null==c?void 0:c.batchSize)||3,h=[];try{h=d.map(e=>a(e.name,o?"".concat(o,"/").concat(e.webkitRelativePath):e.webkitRelativePath));for(let e=0;e<d.length;e+=u){let t=d.slice(e,e+u);await Promise.all(t.map((t,a)=>n(t,o,h[e+a])));let a=Math.min((e+u)/d.length*100,100);null==c||null===(r=c.onProgress)||void 0===r||r.call(c,a)}null==c||null===(s=c.onComplete)||void 0===s||s.call(c)}catch(e){h.forEach(e=>l(e)),null==c||null===(i=c.onError)||void 0===i||i.call(c,e instanceof Error?e.message:"Upload failed")}},isUploading:t}}(),{refetch:C}=(0,D.s)();(0,u.useEffect)(()=>{C()},[C]);let S=async t=>{var a;let s=null===(a=t.target.files)||void 0===a?void 0:a[0];s&&await k(s,e,{onError:e=>alert(e),onComplete:()=>{w.current&&(w.current.value=""),g()}})},A=async t=>{t.target.files&&t.target.files.length>0&&await _(t.target,e,{onError:e=>alert(e),onComplete:()=>{N.current&&(N.current.value=""),g()}})},M=""===e?{files:[],folders:[],datasources:p}:{files:a,folders:n,datasources:void 0};return m?(0,s.jsx)("div",{className:"text-red-500",children:m}):(0,s.jsxs)("div",{className:"w-full h-full bg-white rounded-lg shadow-sm p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(X,{currentPath:e,currentDatasource:t,onNavigate:f}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[""===e?(0,s.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>b(!0),children:[(0,s.jsx)(r.A,{className:"h-4 w-4 mr-2"}),"New Datasource"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"file",ref:w,className:"hidden",onChange:S}),(0,s.jsx)("input",{type:"file",ref:N,className:"hidden",webkitdirectory:"",directory:"",onChange:A}),(0,s.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.click()},children:[(0,s.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Upload File"]}),(0,s.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},children:[(0,s.jsx)(i,{className:"h-4 w-4 mr-2"}),"Upload Folder"]})]}),(0,s.jsx)("div",{className:"border-l h-6 mx-2"}),(0,s.jsx)(h.$,{variant:"grid"===v?"secondary":"ghost",size:"icon",onClick:()=>y("grid"),children:(0,s.jsx)(o,{className:"h-4 w-4"})}),(0,s.jsx)(h.$,{variant:"list"===v?"secondary":"ghost",size:"icon",onClick:()=>y("list"),children:(0,s.jsx)(c,{className:"h-4 w-4"})})]})]}),x?(0,s.jsx)("div",{className:"flex items-center justify-center flex-1",children:(0,s.jsx)(d.A,{className:"w-6 h-6 animate-spin"})}):(0,s.jsx)(Y,{files:M.files,folders:M.folders,datasources:M.datasources,viewMode:v,onFolderClick:f,onDatasourceClick:e=>{"FILES"==e.type&&f("".concat(e.name))},onUploadComplete:g}),(0,s.jsx)(W,{open:j,onClose:()=>b(!1),onCreated:g})]})}function ee(){return(0,s.jsx)("div",{className:"flex-1 h-full w-full",children:(0,s.jsx)(K,{})})}},7925:(e,t,a)=>{"use strict";a.d(t,{Bo:()=>s.Bo,Dz:()=>s.Dz,HT:()=>s.HT,IV:()=>s.IV,Lz:()=>s.Lz,Sc:()=>s.Sc,U5:()=>s.U5,XU:()=>s.XU,YP:()=>s.YP,bJ:()=>s.bJ,cX:()=>s.cX,cn:()=>s.cn,eE:()=>s.eE,fw:()=>s.fw,go:()=>s.go,hV:()=>s.hV,kC:()=>s.kC,kN:()=>s.kN,mc:()=>s.mc,tF:()=>s.tF,v9:()=>s.v9,vB:()=>s.vB,xA:()=>s.xA,xz:()=>s.xz});var s=a(1601)},1235:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(3463),r=a(9795);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},2971:(e,t,a)=>{"use strict";a.d(t,{s:()=>i});var s=a(2115),r=a(1333),l=a(7925);let n=(0,a(9827).v)(e=>({stacks:[],steps:[],setStacks:t=>e({stacks:t}),setSteps:t=>e({steps:t})}));function i(){let[e,t]=(0,s.useState)(!1),a=(0,r.R)(),{setStacks:i,setSteps:o}=n(),c=(0,s.useCallback)(async()=>{t(!0);try{let[e,t]=await Promise.all([(0,l.go)({client:a}),(0,l.cn)({client:a})]);i(e.data||[]),o(t.data||[])}catch(e){console.error("Error fetching processing stacks:",e)}finally{t(!1)}},[a,i,o]);return{stacks:n(e=>e.stacks),steps:n(e=>e.steps),loading:e,refetch:c}}},9393:(e,t,a)=>{"use strict";a.d(t,{$:()=>c,r:()=>o});var s=a(5155),r=a(2115),l=a(2317),n=a(1027),i=a(1235);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:c=!1,...d}=e,u=c?l.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:r,size:n,className:a})),ref:t,...d})});c.displayName="Button"},705:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>h,L3:()=>m,c7:()=>p,lG:()=>o,zM:()=>c});var s=a(5155),r=a(2115),l=a(6217),n=a(689),i=a(1235);let o=l.bL,c=l.l9,d=l.ZL;l.bm;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});u.displayName=l.hJ.displayName;let h=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(l.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[r,(0,s.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=l.UC.displayName;let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};p.displayName="DialogHeader";let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});m.displayName=l.hE.displayName},9367:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(5155),r=a(2115),l=a(1235);let n=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},6631:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var s=a(5155),r=a(2115),l=a(1235);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});n.displayName="Textarea"},9471:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i,k:()=>n});var s=a(5155),r=a(2115);let l=(0,r.createContext)(null);function n(e){let{children:t}=e,[a,n]=(0,r.useState)([]),i=(0,r.useCallback)(e=>{n(t=>[...t,...e])},[]),o=(0,r.useCallback)((e,t)=>{n(a=>a.map(a=>a.id===e?{...a,...t}:a))},[]),c=(0,r.useCallback)(e=>{n(t=>t.filter(t=>t.id!==e))},[]),d=(0,r.useCallback)(()=>{n([])},[]);return(0,s.jsx)(l.Provider,{value:{items:a,addItems:i,updateItem:o,removeItem:c,resetAll:d},children:t})}function i(){let e=(0,r.useContext)(l);if(!e)throw Error("useToastContext must be used within a ToastContextProvider");return e}},3244:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});var s=a(2818);function r(){return{backend:"hosted"!==s.env.DEPLOYEMENT_TYPE?window.location.origin:(s.env.ENVIRONMENT,"https://localhost")}}},1333:(e,t,a)=>{"use strict";a.d(t,{R:()=>i});var s=a(7264),r=a(3244),l=a(2115),n=a(7908);function i(){let{token:e,logout:t}=(0,n.A)(),{backend:a}=(0,r.T)();return(0,l.useMemo)(()=>{let r=(0,s.UU)((0,s.Z3)({baseUrl:a}));return r.interceptors.request.use((t,a)=>(e&&t.headers.set("Authorization","Bearer ".concat(e)),t)),r.interceptors.response.use((e,a)=>(401===e.status&&t(),e)),r},[a,e,t])}},4683:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(4057).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9827:(e,t,a)=>{"use strict";a.d(t,{v:()=>o});var s=a(2115);let r=e=>{let t;let a=new Set,s=(e,s)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=s?s:"object"!=typeof r||null===r)?r:Object.assign({},t,r),a.forEach(a=>a(t,e))}},r=()=>t,l={setState:s,getState:r,getInitialState:()=>n,subscribe:e=>(a.add(e),()=>a.delete(e))},n=t=e(s,r,l);return l},l=e=>e?r(e):r,n=e=>e,i=e=>{let t=l(e),a=e=>(function(e,t=n){let a=s.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return s.useDebugValue(a),a})(t,e);return Object.assign(a,t),a},o=e=>e?i(e):i}},e=>{var t=t=>e(e.s=t);e.O(0,[738,906,119,895,641,153,908,441,517,358],()=>t(6443)),_N_E=e.O()}]);